# Test Design: Story 8.1 - Shadow Work Spread (VIP-Only)

**Story:** 8.1  
**Component:** Shadow Work Spread - Deep Introspective Reading  
**QA Engineer:** Quinn (Test Architect)  
**Date:** 2026-01-13  
**Risk Level:** MEDIUM-HIGH (Content sensitivity + VIP-only)

---

## 1. Test Strategy

### Test Levels
- **Unit Tests** (40%): Card selection, position logic
- **Component Tests** (30%): Layout rendering, animations
- **Integration Tests** (20%): VIP access control, database
- **E2E Tests** (10%): Complete shadow work flow

### Focus Areas
- **VIP-only access** (strictest tier requirement)
- **Content sensitivity** (psychological appropriateness)
- **Introspective depth** (premium quality)
- **Cultural sensitivity** (Thai context for shadow work)

---

## 2. Test Scenarios

### Scenario 1: VIP-Only Access Control (P0)
**Given-When-Then:**
- **Given** user is Pro tier (not VIP)
- **When** navigates to /reading/shadow-work
- **Then** VIP gate displays
- **And** shows "Upgrade to VIP" message
- **And** explains VIP-exclusive benefits

**Test Cases:**
- TC-8.1-001: FREE user → VIP gate shown
- TC-8.1-002: BASIC user → VIP gate shown
- TC-8.1-003: PRO user → VIP gate shown (VIP required!)
- TC-8.1-004: VIP user → access granted, page loads
- TC-8.1-005: Canceled VIP in grace period → access granted
- TC-8.1-006: Expired VIP subscription → gate shown
- TC-8.1-007: VIP gate shows clear benefits ("Most exclusive spread")

**Priority:** P0 (VIP-exclusive revenue protection)

---

### Scenario 2: Shadow Work Spread Layout (P1)
**Given-When-Then:**
- **Given** VIP user on Shadow Work page
- **When** drawing cards
- **Then** displays shadow-focused positions
- **And** layout appropriate for introspective theme

**Expected Card Count:** 5-7 cards (to be confirmed)

**Position Examples:**
1. Shadow Self (hidden aspects)
2. Light Self (conscious self)
3. Integration Point
4. Challenges to Face
5. Path to Wholeness

**Test Cases:**
- TC-8.1-010: Correct number of cards (5-7)
- TC-8.1-011: Shadow-focused position labels (Thai + English)
- TC-8.1-012: Layout creates introspective atmosphere
- TC-8.1-013: Dark/contemplative visual theme
- TC-8.1-014: Mobile responsive (vertical stack)
- TC-8.1-015: Position order logical (shadow → light → integration)

**Priority:** P1

---

### Scenario 3: Content Sensitivity & Appropriateness (P0)
**Given-When-Then:**
- **Given** shadow work interpretation content
- **When** reviewing for psychological appropriateness
- **Then** content supportive and safe
- **And** trigger warnings included (if needed)
- **And** professional guidance provided

**Test Cases:**
- TC-8.1-020: Content addresses shadow self appropriately
- TC-8.1-021: Not overly dark or frightening
- TC-8.1-022: Supportive, growth-oriented language
- TC-8.1-023: Includes trigger warning if needed
- TC-8.1-024: Encourages self-reflection (not judgment)
- TC-8.1-025: Suggests professional help if deep issues
- TC-8.1-026: Thai language culturally sensitive
- TC-8.1-027: No harmful psychological content
- TC-8.1-028: Reviewed by psychologist or counselor (recommended)

**Priority:** P0 (User safety, reputation, ethical responsibility)

---

### Scenario 4: Card Selection & Drawing (P0)
**Given-When-Then:**
- **Given** shadow work reading requested
- **When** drawing cards
- **Then** 5-7 unique cards selected
- **And** no duplicates
- **And** reversed status assigned

**Test Cases:**
- TC-8.1-030: Exactly correct number of cards drawn
- TC-8.1-031: All cards unique (no duplicates)
- TC-8.1-032: Random selection from 78-card deck
- TC-8.1-033: Reversed status 50/50 probability
- TC-8.1-034: Major Arcana appropriate for shadow work

**Priority:** P0

---

### Scenario 5: Position-Specific Interpretations (P0)
**Given-When-Then:**
- **Given** shadow work cards drawn
- **When** viewing interpretations
- **Then** each position has unique context
- **And** shadow work theme consistent

**Test Cases:**
- TC-8.1-040: Shadow Self position interpretation appropriate
- TC-8.1-041: Light Self position interpretation balancing
- TC-8.1-042: Integration position provides guidance
- TC-8.1-043: All positions have 100-150 words
- TC-8.1-044: Content depth appropriate for VIP tier
- TC-8.1-045: Thai language sophisticated

**Priority:** P0 (Premium content quality)

---

### Scenario 6: Save Shadow Work Reading (P0)
**Given-When-Then:**
- **Given** shadow work reading complete
- **When** saving to database
- **Then** reading_type = "shadow_work"
- **And** VIP-only indicator set
- **And** appears in history

**Test Cases:**
- TC-8.1-050: Saves with correct reading_type
- TC-8.1-051: All cards saved with positions
- TC-8.1-052: VIP badge shown in history
- TC-8.1-053: Can reload saved reading
- TC-8.1-054: Privacy marker (sensitive content)
- TC-8.1-055: User can delete (privacy)

**Priority:** P0

---

### Scenario 7: Privacy & Sensitivity Handling (P1)
**Given-When-Then:**
- **Given** shadow work readings are personal/sensitive
- **When** handling data
- **Then** extra privacy protection
- **And** user controls visibility

**Test Cases:**
- TC-8.1-060: Shadow work readings private by default
- TC-8.1-061: Cannot be shared (or warning shown)
- TC-8.1-062: User can delete anytime
- TC-8.1-063: Not included in public analytics
- TC-8.1-064: Special privacy icon in history

**Priority:** P1 (User privacy)

---

### Scenario 8: Premium Visual Theme (P2)
**Test Cases:**
- TC-8.1-070: Dark, contemplative visual design
- TC-8.1-071: Appropriate imagery (not scary)
- TC-8.1-072: Professional appearance
- TC-8.1-073: Consistent with brand

**Priority:** P2

---

## 3. Integration Test Scenarios

### Scenario 9: VIP Subscription Check (P0)
**Given-When-Then:**
- **Given** user attempts shadow work reading
- **When** checking subscription
- **Then** server-side VIP validation
- **And** API returns 403 if not VIP

**Test Cases:**
- TC-8.1-080: Server-side VIP check (not just client)
- TC-8.1-081: API endpoint protected
- TC-8.1-082: Middleware validates tier
- TC-8.1-083: No bypass possible

**Priority:** P0

---

### Scenario 10: Database Schema Support (P0)
**Test Cases:**
- TC-8.1-090: ReadingType enum includes "shadow_work"
- TC-8.1-091: Supports 5-7 cards in reading_cards
- TC-8.1-092: Privacy flag supported (optional)

**Priority:** P0

---

## 4. E2E Test Scenarios

### Scenario 11: Complete Shadow Work Journey (P0)
**Steps:**
1. Login as VIP user
2. Navigate to spread selection
3. Click "Shadow Work" (VIP badge visible)
4. Read trigger warning/intro (if present)
5. Enter reflective question
6. Draw cards
7. View shadow-focused interpretations
8. Reflect on guidance
9. Save reading (private)
10. Verify appears in history with privacy marker

**Priority:** P0

---

### Scenario 12: VIP Upgrade from Pro (P1)
**Steps:**
1. Login as Pro user
2. Navigate to Shadow Work
3. See VIP gate
4. Click "Upgrade to VIP"
5. Complete upgrade (proration)
6. Return to Shadow Work
7. Access granted

**Priority:** P1

---

## 5. Risk Coverage Matrix

| Risk | Severity | Test Coverage | Mitigation |
|------|----------|---------------|------------|
| Content causes psychological harm | HIGH | TC-8.1-020-028 | Expert review, trigger warnings |
| Unauthorized VIP access | HIGH | TC-8.1-001-007, 080-083 | Server-side validation |
| Privacy breach | MEDIUM | TC-8.1-060-064 | Privacy controls |
| Poor content quality | MEDIUM | TC-8.1-040-045 | Expert review, QA |

---

## 6. Test Execution Plan

### Phase 1: Access Control (Day 1)
- Implement TC-8.1-001 to TC-8.1-007
- VIP gating verification

### Phase 2: Content Review (Day 2-3)
- Manual QA: TC-8.1-020 to TC-8.1-028
- Expert review (psychologist recommended)
- Thai language sensitivity check

### Phase 3: Functionality (Day 3-4)
- Card drawing logic
- Layout rendering
- Save and history

### Phase 4: Integration & E2E (Day 4-5)
- API integration
- Complete user journey
- Privacy features

---

## 7. Success Criteria

✅ **VIP Access:**
- [ ] Only VIP users can access
- [ ] Server-side validation working
- [ ] Gate shows clear upgrade path

✅ **Content Safety:**
- [ ] Expert reviewed content
- [ ] Psychologically appropriate
- [ ] Trigger warnings if needed
- [ ] Supportive language throughout

✅ **Premium Quality:**
- [ ] Content depth appropriate for VIP
- [ ] Thai language sophisticated
- [ ] Introspective and valuable

✅ **Privacy:**
- [ ] Readings private by default
- [ ] User can control visibility
- [ ] Can delete anytime

✅ **Overall:**
- [ ] All P0 tests passing
- [ ] Code coverage >85%
- [ ] User feedback positive
- [ ] Ethical review passed

---

**Estimated Effort:** 3-4 days  
**Special Requirements:** 
- Psychologist/counselor review (recommended)
- Thai cultural sensitivity expert
- Ethics review

**Dependencies:**
- Story 7.5 (Layouts) must be complete
- Story 7.6 (Content creation pattern) established
