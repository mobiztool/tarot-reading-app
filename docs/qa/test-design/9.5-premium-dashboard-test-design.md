# Test Design: Story 9.5 - Premium User Dashboard (Pro/VIP Feature)

**Story:** 9.5  
**Component:** Premium Dashboard with Stats & Quick Actions  
**QA Engineer:** Quinn (Test Architect)  
**Date:** 2026-01-13  
**Risk Level:** MEDIUM (Data aggregation, visualization)

---

## 1. Test Strategy

### Test Levels
- **Unit Tests** (40%): Stat calculations, data aggregation
- **Component Tests** (30%): Dashboard widgets, charts
- **Integration Tests** (20%): API, database queries
- **E2E Tests** (10%): User dashboard experience

### Focus Areas
- **Pro/VIP access** control
- **Metrics accuracy** (reading count, subscription status)
- **Data visualization** (charts, stats)
- **Quick actions** (start reading, manage subscription)
- **Performance** (dashboard should load fast)

---

## 2. Test Scenarios

### Scenario 1: Pro/VIP Access Control (P0)
**Given-When-Then:**
- **Given** user is BASIC tier
- **When** navigates to /profile/dashboard
- **Then** redirected to pricing or gate shown
- **And** explains dashboard is Pro/VIP feature

**Test Cases:**
- TC-9.5-001: FREE users → redirect to pricing
- TC-9.5-002: BASIC users → redirect to pricing
- TC-9.5-003: PRO users → dashboard access granted
- TC-9.5-004: VIP users → dashboard access (enhanced features)
- TC-9.5-005: Gate explains dashboard benefits

**Priority:** P0

---

### Scenario 2: Dashboard Metrics Display (P0)
**Given-When-Then:**
- **Given** Pro/VIP user on dashboard
- **When** page loads
- **Then** displays key metrics:
  - Total readings count
  - Readings this week/month
  - Current subscription tier
  - Next billing date
  - Favorite spread
  - Most common card

**Test Cases:**
- TC-9.5-010: Total readings count accurate
- TC-9.5-011: Weekly readings accurate
- TC-9.5-012: Monthly readings accurate
- TC-9.5-013: Subscription status current
- TC-9.5-014: Next billing date correct
- TC-9.5-015: Favorite spread calculated correctly
- TC-9.5-016: Most common card accurate
- TC-9.5-017: All metrics load within 1 second

**Priority:** P0 (Core dashboard value)

---

### Scenario 3: Reading Activity Chart (P1)
**Given-When-Then:**
- **Given** user's reading history
- **When** displaying activity chart
- **Then** shows readings over time
- **And** interactive visualization

**Test Cases:**
- TC-9.5-020: Line/bar chart shows reading frequency
- TC-9.5-021: Time range selectable (7 days, 30 days, 90 days, all time)
- TC-9.5-022: Data points accurate
- TC-9.5-023: Hover shows details (date, count)
- TC-9.5-024: Mobile responsive
- TC-9.5-025: Empty state if no data

**Priority:** P1

---

### Scenario 4: Spread Distribution Chart (P1)
**Given-When-Then:**
- **Given** user has tried multiple spreads
- **When** viewing spread distribution
- **Then** pie/donut chart shows usage
- **And** breakdown by spread type

**Test Cases:**
- TC-9.5-030: Pie chart shows spread distribution
- TC-9.5-031: Percentages accurate
- TC-9.5-032: All spreads user tried included
- TC-9.5-033: Colors distinctive
- TC-9.5-034: Legend clear (Thai labels)
- TC-9.5-035: Click slice → filter to that spread

**Priority:** P1

---

### Scenario 5: Quick Actions (P1)
**Given-When-Then:**
- **Given** dashboard loaded
- **When** viewing quick actions section
- **Then** provides shortcuts:
  - Start new reading (favorite spread)
  - View reading history
  - Manage subscription
  - Export reports

**Test Cases:**
- TC-9.5-040: "New Reading" button opens spread selection
- TC-9.5-041: "Favorite Spread" quick start works
- TC-9.5-042: "View History" navigates to history
- TC-9.5-043: "Manage Subscription" goes to billing
- TC-9.5-044: All buttons functional
- TC-9.5-045: Mobile: buttons accessible

**Priority:** P1

---

### Scenario 6: Subscription Status Widget (P0)
**Given-When-Then:**
- **Given** dashboard loaded
- **When** viewing subscription widget
- **Then** shows:
  - Current tier (Pro/VIP)
  - Subscription status
  - Next billing date
  - Features available

**Test Cases:**
- TC-9.5-050: Tier displayed correctly
- TC-9.5-051: Status accurate (active, trialing, etc.)
- TC-9.5-052: Billing date correct
- TC-9.5-053: "Manage" button goes to subscription page
- TC-9.5-054: Trial countdown shown (if trialing)
- TC-9.5-055: Upgrade CTA if Pro (suggest VIP)

**Priority:** P0

---

### Scenario 7: Recent Readings Widget (P1)
**Given-When-Then:**
- **Given** user has recent readings
- **When** viewing recent readings section
- **Then** shows last 5 readings
- **And** quick preview

**Test Cases:**
- TC-9.5-060: Last 5 readings displayed
- TC-9.5-061: Sorted by date (newest first)
- TC-9.5-062: Shows spread type, date, preview
- TC-9.5-063: Click reading → full reading view
- TC-9.5-064: Empty state if no readings

**Priority:** P1

---

### Scenario 8: VIP-Specific Features (P1)
**Given-When-Then:**
- **Given** VIP user (vs Pro user)
- **When** viewing dashboard
- **Then** VIP sees enhanced features:
  - Pattern analysis link
  - AI interpretation stats
  - Advanced metrics

**Test Cases:**
- TC-9.5-070: VIP dashboard has pattern analysis widget
- TC-9.5-071: VIP sees AI usage stats (if Story 9.2)
- TC-9.5-072: Pro dashboard simpler (no VIP features)
- TC-9.5-073: Clear differentiation between Pro/VIP dashboards

**Priority:** P1

---

### Scenario 9: Dashboard Performance (P0)
**Given-When-Then:**
- **Given** dashboard with multiple metrics
- **When** measuring load time
- **Then** loads quickly (< 1.5s)
- **And** data queries optimized

**Test Cases:**
- TC-9.5-080: Initial page load < 1.5s
- TC-9.5-081: Metrics load progressively (not blocking)
- TC-9.5-082: Charts render smoothly
- TC-9.5-083: Database queries optimized (indexes, aggregations)
- TC-9.5-084: No layout shift during load
- TC-9.5-085: Caching strategy implemented

**Priority:** P0 (UX - dashboard should feel fast)

---

### Scenario 10: Mobile Responsive Dashboard (P0)
**Given-When-Then:**
- **Given** mobile device
- **When** viewing dashboard
- **Then** layout adapts:
  - Widgets stack vertically
  - Charts readable
  - Quick actions accessible

**Test Cases:**
- TC-9.5-090: Desktop: multi-column layout
- TC-9.5-091: Mobile: single column stack
- TC-9.5-092: Charts scale to screen width
- TC-9.5-093: Touch-friendly buttons
- TC-9.5-094: Scrolling smooth
- TC-9.5-095: No horizontal scroll

**Priority:** P0 (Mobile UX)

---

## 3. Integration Test Scenarios

### Scenario 11: Dashboard API (P0)
**Test Cases:**
- TC-9.5-100: GET /api/dashboard/stats endpoint
- TC-9.5-101: Pro/VIP tier validated
- TC-9.5-102: Returns all metrics in single call
- TC-9.5-103: Response time < 500ms
- TC-9.5-104: Data accurate from database

**Priority:** P0

---

### Scenario 12: Real-time Updates (P2)
**Test Cases:**
- TC-9.5-110: Dashboard updates after new reading
- TC-9.5-111: Subscription changes reflected
- TC-9.5-112: No manual refresh needed (optional)

**Priority:** P2

---

## 4. E2E Test Scenarios

### Scenario 13: Complete Dashboard Experience (P0)
**Steps:**
1. Login as Pro user
2. Navigate to /profile/dashboard
3. View all metrics loaded
4. Check reading count accurate
5. View charts (activity, spread distribution)
6. Click "New Reading" quick action
7. Complete reading
8. Return to dashboard
9. Verify count updated (+1)

**Priority:** P0

---

### Scenario 14: Pro vs VIP Dashboard (P1)
**Steps:**
1. Login as Pro → view dashboard (standard)
2. Upgrade to VIP
3. Return to dashboard
4. Verify VIP features now visible (pattern analysis, etc.)

**Priority:** P1

---

## 5. Test Data Requirements

### Test Users
```javascript
{
  pro_new: { readings: 5, subscription: "pro", joined: "1 week ago" },
  pro_active: { readings: 50, subscription: "pro", joined: "3 months ago" },
  vip_power: { readings: 200, subscription: "vip", joined: "6 months ago" },
}
```

### Dashboard Metrics
```javascript
{
  total_readings: 50,
  this_week: 7,
  this_month: 28,
  favorite_spread: "three_card",
  most_common_card: "The Fool",
  subscription_tier: "pro",
  next_billing: "2026-02-13",
}
```

---

## 6. Success Criteria

✅ **Access Control:**
- [ ] Pro/VIP only access
- [ ] FREE/BASIC redirected
- [ ] Clear tier benefits

✅ **Metrics Accuracy:**
- [ ] All counts accurate
- [ ] Charts represent data correctly
- [ ] Calculations verified

✅ **UX:**
- [ ] Dashboard loads fast (< 1.5s)
- [ ] Visualizations clear
- [ ] Quick actions functional
- [ ] Mobile responsive

✅ **Value:**
- [ ] Pro users find value in dashboard
- [ ] VIP features differentiated
- [ ] Drives engagement

✅ **Overall:**
- [ ] All P0 tests passing
- [ ] Code coverage >85%
- [ ] User satisfaction with dashboard

---

**Estimated Effort:** 3-4 days

**Dependencies:**
- Chart library (Chart.js, Recharts)
- Pattern analysis algorithm (Story 9.4)
- Reading history data
