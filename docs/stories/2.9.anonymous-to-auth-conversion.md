# Story 2.9: Anonymous to Authenticated User Conversion

## Status

**Approved**

---

## Story

**As an** anonymous user who has already done readings,  
**I want** to be prompted to sign up to save my readings,  
**so that** I don't lose my reading history.

---

## Acceptance Criteria

1. After 2nd or 3rd reading, show signup prompt: "Sign up to save your readings"
2. Prompt displayed as modal or banner (non-intrusive)
3. Dismiss option: user can close prompt and continue as anonymous
4. Prompt frequency: show maximum once per day (don't annoy users)
5. CTA buttons: "Sign up now" (navigates to signup), "Maybe later" (dismisses)
6. Value proposition clear: "Don't lose your readings. Sign up for free."
7. If user signs up, attempt to claim previous anonymous readings (match by device/session)
8. Reading claiming: update `user_id` for readings from same browser session
9. Claimed readings appear in user's history immediately after signup
10. Analytics tracked: `signup_prompt_shown`, `signup_from_prompt`, `readings_claimed_count`

---

## Tasks / Subtasks

- [ ] **Task 1: Track Reading Count** (AC: 1)
  - [ ] Count anonymous readings in session
  - [ ] Show prompt after 2nd or 3rd reading

- [ ] **Task 2: Create Signup Prompt** (AC: 2, 6)
  - [ ] Modal or banner component
  - [ ] Clear value proposition
  - [ ] CTA buttons with good copy

- [ ] **Task 3: Prompt Frequency Control** (AC: 3, 4)
  - [ ] Track when last shown (localStorage)
  - [ ] Don't show more than once per day
  - [ ] Respect dismissal

- [ ] **Task 4: Reading Claiming** (AC: 7, 8, 9)
  - [ ] Store session ID in anonymous readings
  - [ ] After signup: claim readings with matching session
  - [ ] Show success: "3 readings added to your history!"

- [ ] **Task 5: Analytics** (AC: 10)
  - [ ] Track: `signup_prompt_shown`, `signup_from_prompt`, `readings_claimed_count`

- [ ] **Task 6: Testing** (AC: 1-10)
  - [ ] Test prompt timing
  - [ ] Test claiming flow
  - [ ] Test frequency limits

---

## Dev Notes

**From Story 2.5:** Session-based reading claiming infrastructure ready

Key to conversion funnel optimization

---

## Change Log

| Date       | Version | Description            | Author           |
| ---------- | ------- | ---------------------- | ---------------- |
| 2026-01-01 | 1.0     | Initial story creation | Sarah (PO Agent) |
